<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>360 ì´ë¯¸ì§€ ê°¤ëŸ¬ë¦¬ (Final)</title>
  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  <style>
    /* ì¸ë„¤ì¼ ì»¨í…Œì´ë„ˆ */
    .thumbnail-container {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 120px;
      background: rgba(0, 0, 0, 0.6);
      display: flex;
      align-items: center;
      overflow-x: auto;
      white-space: nowrap;
      padding: 10px;
      z-index: 999;
    }
    .thumb-item {
      display: inline-block;
      margin-right: 15px;
      text-align: center;
      cursor: pointer;
      flex-shrink: 0;
      opacity: 0.6;
      transition: 0.2s;
    }
    .thumb-item:hover { opacity: 1; transform: scale(1.05); }
    .thumb-item.active { opacity: 1; }
    .thumb-item.active img { border: 3px solid #FFD700; }
    
    .thumb-item img {
      width: 140px;
      height: 80px;
      object-fit: cover;
      border-radius: 5px;
      background-color: #333; /* ì´ë¯¸ì§€ ë¡œë”© ì „ ë°°ê²½ìƒ‰ */
    }
    .thumb-item span {
      display: block;
      color: white;
      font-size: 12px;
      margin-top: 5px;
    }

    /* ë””ë²„ê·¸ ë¡œê·¸ ì°½ */
    #debug-console {
      position: absolute;
      top: 50px;
      left: 10px;
      width: 300px;
      height: 200px;
      background: rgba(0, 0, 0, 0.8);
      color: #00ff00;
      font-size: 12px;
      padding: 10px;
      overflow-y: auto;
      z-index: 9999;
      pointer-events: none;
      display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
    }

    /* ë¡œê·¸ í† ê¸€ ë²„íŠ¼ */
    #toggle-debug-btn {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 10000;
      padding: 5px 10px;
      background: #333;
      color: white;
      border: 1px solid #555;
      cursor: pointer;
    }
  </style>
</head>
<body>
  
  <button id="toggle-debug-btn" onclick="toggleDebug()">ğŸ ë””ë²„ê·¸ ë¡œê·¸ ì¼œê¸°/ë„ê¸°</button>
  
  <div id="debug-console">=== ì‹œìŠ¤í…œ ë¡œê·¸ ===<br></div>

  <a-scene vr-mode-ui="enabled: false" loading-screen="dotsColor: white; backgroundColor: black">
    
    <a-entity light="type: ambient; color: #FFF; intensity: 1.5"></a-entity>

    <a-sky id="background-sky" src="" rotation="0 -90 0"></a-sky>
    
    <a-entity camera look-controls>
      <a-cursor color="yellow" scale="0.5 0.5 0.5" raycaster="objects: none"></a-cursor>
    </a-entity>
  </a-scene>

  <div class="thumbnail-container" id="thumb-scroll-container"></div>

  <script>
    const totalImagesToCheck = 50; 
    const container = document.getElementById('thumb-scroll-container');
    const sky = document.getElementById('background-sky');
    const debugBox = document.getElementById('debug-console');

    // ë””ë²„ê·¸ ì°½ ì¼œê³  ë„ëŠ” í•¨ìˆ˜
    function toggleDebug() {
      if (debugBox.style.display === 'none') {
        debugBox.style.display = 'block';
      } else {
        debugBox.style.display = 'none';
      }
    }

    // ì•ˆì „í•œ ë¡œê·¸ ê¸°ë¡ í•¨ìˆ˜ (ì—ëŸ¬ ë°©ì§€)
    function log(msg) {
      if (debugBox) {
        debugBox.innerHTML += msg + "<br>";
        debugBox.scrollTop = debugBox.scrollHeight;
      }
      console.log(msg); // ë¸Œë¼ìš°ì € ì½˜ì†”ì—ë„ ê¸°ë¡
    }

    // ì´ë¯¸ì§€ ë¡œë”
    function createThumbnail(index) {
      const baseName = "image_" + index;
      
      const img = new Image();
      const thumbWrapper = document.createElement('div');
      thumbWrapper.className = 'thumb-item';
      thumbWrapper.id = 'thumb-' + index;

      // 1. PNG ë¨¼ì € ì‹œë„
      const tryPng = baseName + ".png";
      const tryJpg = baseName + ".jpg";

      img.src = tryPng;

      // PNG ì„±ê³µ ì‹œ
      img.onload = function() {
        log(`âœ… [${baseName}] PNG ë¡œë“œ ì„±ê³µ`);
        finalizeThumbnail(thumbWrapper, img, tryPng, baseName, index);
      };

      // PNG ì‹¤íŒ¨ ì‹œ -> JPG ì‹œë„
      img.onerror = function() {
        // ì´ë¯¸ JPG ì‹œë„ ì¤‘ì´ì—ˆë‹¤ë©´ (srcê°€ jpgë¡œ ëë‚œë‹¤ë©´) -> ì™„ì „ ì‹¤íŒ¨
        if (img.src.endsWith(".jpg")) {
           // ì¡°ìš©íˆ ì¢…ë£Œ (ë¡œê·¸ë§Œ ë‚¨ê¹€)
           console.log(`[${baseName}] íŒŒì¼ ì—†ìŒ`);
           return;
        }
        
        // PNG ì‹¤íŒ¨í–ˆìœ¼ë‹ˆ JPGë¡œ ë°”ê¿”ì„œ ì¬ì‹œë„
        log(`âš ï¸ [${baseName}] PNG ì—†ìŒ. JPG ì°¾ëŠ” ì¤‘...`);
        img.src = tryJpg;
      };
    }

    function finalizeThumbnail(wrapper, imgElement, realFileName, labelText, index) {
      const span = document.createElement('span');
      span.textContent = labelText;

      wrapper.appendChild(imgElement);
      wrapper.appendChild(span);

      wrapper.addEventListener('click', function() {
        log(`ğŸš€ ë°°ê²½ ë³€ê²½: ${realFileName}`);
        sky.setAttribute('src', realFileName);
        
        document.querySelectorAll('.thumb-item').forEach(item => item.classList.remove('active'));
        wrapper.classList.add('active');
      });

      container.appendChild(wrapper);

      // ì²« ë²ˆì§¸ ì´ë¯¸ì§€ëŠ” ìë™ìœ¼ë¡œ ë°°ê²½ ì„¤ì •
      if (index === 1) {
        // ì•½ê°„ì˜ ì§€ì—° í›„ ì‹¤í–‰ (ì•ˆì •ì„± í™•ë³´)
        setTimeout(() => wrapper.click(), 500);
      }
    }

    // ì‹¤í–‰ ì‹œì‘
    for (let i = 1; i <= totalImagesToCheck; i++) {
      createThumbnail(i);
    }
  </script>
</body>
</html>
