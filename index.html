<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>360 이미지 갤러리</title>
  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  <style>
    /* 썸네일 컨테이너 스타일 */
    .thumbnail-container {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 120px; /* 컨테이너 높이 */
      background: rgba(0, 0, 0, 0.6); /* 반투명 검은색 배경 */
      display: flex;
      align-items: center;
      overflow-x: auto; /* 가로 스크롤 허용 */
      white-space: nowrap; /* 줄바꿈 방지 */
      padding: 10px;
      box-sizing: border-box;
      z-index: 999; /* A-Frame 위에 표시 */
      /* 스크롤바 스타일 (크롬, 사파리 등) */
      scrollbar-width: thin;
      scrollbar-color: #555 #222;
    }

    /* 스크롤바 숨김 (선택사항 - 깔끔하게 보려면 주석 해제) */
    /* .thumbnail-container::-webkit-scrollbar { display: none; } */

    /* 개별 썸네일 아이템 스타일 */
    .thumb-item {
      display: inline-block;
      margin-right: 15px;
      text-align: center;
      cursor: pointer;
      transition: transform 0.2s;
      flex-shrink: 0; /* 공간이 부족해도 줄어들지 않음 */
    }

    .thumb-item:hover {
      transform: scale(1.05); /* 마우스 오버 시 약간 확대 */
    }

    /* 썸네일 이미지 스타일 */
    .thumb-item img {
      width: 140px; /* 썸네일 가로 크기 */
      height: 80px; /* 썸네일 세로 크기 */
      object-fit: cover; /* 비율 유지하며 꽉 채우기 */
      border-radius: 5px;
      border: 2px solid transparent;
    }

    /* 선택된 썸네일 강조 스타일 */
    .thumb-item.active img {
      border-color: #FFD700; /* 노란색 테두리 */
    }

    /* 썸네일 라벨(텍스트) 스타일 */
    .thumb-item span {
      display: block;
      color: white;
      font-size: 12px;
      margin-top: 5px;
      text-overflow: ellipsis;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <a-scene vr-mode-ui="enabled: false" loading-screen="dotsColor: white; backgroundColor: black">
    
    <a-sky id="background-sky" src="image_1.png" rotation="0 -90 0"></a-sky>

    <a-entity camera look-controls>
      <a-cursor color="yellow" scale="0.5 0.5 0.5" raycaster="objects: none"></a-cursor>
    </a-entity>
  </a-scene>

  <div class="thumbnail-container" id="thumb-scroll-container">
    </div>

  <script>
    // ==========================================
    // 설정 영역
    // ==========================================
    const totalImagesToLoad = 100; // 최대 몇 번 이미지까지 확인할지 설정 (예: 100)
    const fileNamePrefix = "image_"; // 파일명 접두사
    const fileNameSuffix = ".png"; // 확장자
    let currentActiveId = 1; // 현재 보고 있는 이미지 번호
    // ==========================================


    const container = document.getElementById('thumb-scroll-container');
    const sky = document.getElementById('background-sky');

    // 썸네일 생성 반복문
    for (let i = 1; i <= totalImagesToLoad; i++) {
      const fileName = fileNamePrefix + i + fileNameSuffix;
      const labelText = fileNamePrefix + i; // 라벨에 표시될 텍스트 (예: image_1)

      // 1. 썸네일 감싸는 div 생성
      const thumbWrapper = document.createElement('div');
      thumbWrapper.className = 'thumb-item';
      if (i === 1) thumbWrapper.classList.add('active'); // 첫 번째 이미지를 기본 선택 상태로
      thumbWrapper.id = 'thumb-' + i;

      // 2. 이미지 태그 생성
      // 주의: 실제 큰 이미지를 썸네일로 사용하므로 데이터 사용량이 많을 수 있습니다.
      const imgElement = document.createElement('img');
      imgElement.src = fileName;
      imgElement.alt = labelText;

      // ***핵심 기능: 파일이 존재하지 않으면 썸네일을 숨김***
      imgElement.onerror = function() {
        thumbWrapper.style.display = 'none';
      };

      // 3. 라벨(텍스트) 태그 생성
      const spanElement = document.createElement('span');
      spanElement.textContent = labelText;

      // 4. 구조 조립 (div 안에 img와 span 넣기)
      thumbWrapper.appendChild(imgElement);
      thumbWrapper.appendChild(spanElement);

      // 5. 클릭 이벤트 추가
      thumbWrapper.addEventListener('click', function() {
        // 배경 이미지 변경
        sky.setAttribute('src', fileName);
        
        // 활성 상태 스타일 변경 (이전 것 끄고, 클릭한 것 켜기)
        document.getElementById('thumb-' + currentActiveId).classList.remove('active');
        thumbWrapper.classList.add('active');
        currentActiveId = i;
      });

      // 6. 최종적으로 컨테이너에 추가
      container.appendChild(thumbWrapper);
    }
  </script>
</body>
</html>
